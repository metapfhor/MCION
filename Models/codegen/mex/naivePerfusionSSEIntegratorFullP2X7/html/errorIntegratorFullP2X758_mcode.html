<pre class="code">
<span class="srcline"><span class="lineno"><a href="28,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">err</span> = errorIntegratorFullP2X7(<span class="var type1" id="S3T1U6">ton</span>,<span class="var type1" id="S4T1U7">toff</span>,<span class="var type1" id="S5T1U8">Ttot</span>,<span class="var type1" id="S6T1U9">amp</span>,<span class="var type1" id="S7T6U10">y0</span>,<span class="var type1" id="S8T7U11">T</span>,<span class="var type1" id="S9T7U12">I</span>,<span class="mxinfo" id="T1:U9"><span class="var type1" id="S10T1U13">V</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="28,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">global</span> <span class="var type1" id="S11T1U15">k1</span> <span class="var type1" id="S12T1U16">k2</span> <span class="var type1" id="S13T1U17">k3</span> <span class="var type1" id="S14T1U18">k4</span> <span class="var type1" id="S15T1U19">k5</span> <span class="var type1" id="S16T1U20">k6</span> <span class="var type1" id="S17T1U21">L1</span> <span class="var type1" id="S18T1U22">L2</span> <span class="var type1" id="S19T1U23">L3</span> <span class="var type1" id="S20T1U24">H1</span> <span class="var type1" id="S21T1U25">H2</span> <span class="var type1" id="S22T1U26">H3</span> <span class="var type1" id="S23T1U27">H4</span> <span class="var type1" id="S24T1U28">H5</span> <span class="var type1" id="S25T1U29">H6</span> <span class="var type1" id="S26T1U30">H7</span> <span class="var type1" id="S27T1U31">g12</span> <span class="var type1" id="S28T1U32">g34</span> <span class="var type1" id="S29T1U33">E12</span> <span class="var type1" id="S30T1U34">E34</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,3" id="srcline3"> 3</a></span><span class="line">    <span class="mxinfo" id="T1:U31"><span class="var type1" id="S31T1U37">dt</span>=<span class="mxinfo" id="T1:U33"><span class="fcn" id="F41N5:B39">getFDTimeStepFullP2X7</span>(<span class="var type1" id="S6T1U40">amp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,4" id="srcline4"> 4</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,5" id="srcline5"> 5</a></span><span class="line">    <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo" id="T1:U35"><span class="var type1" id="S33T1U43">nT</span>=<span class="mxinfo" id="T1:U37"><span class="mxinfo" id="T1:U38">min(<span class="var type1" id="S5T1U47">Ttot</span>,<span class="mxinfo" id="T1:U40"><span class="var type1" id="S8T7U49">T</span>(<span class="mxinfo" id="T1:U42">end</span>)</span>)</span>/<span class="var type1" id="S31T1U52">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo" id="T6:U44"><span class="var type1" id="S36T6U55">ycurr</span>=<span class="var type1" id="S7T6U56">y0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo" id="T6:U47"><span class="var type1" id="S37T6U59">yup</span>=<span class="mxinfo" id="T6:U49">zeros(size(<span class="var type1" id="S7T6U64">y0</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo" id="T1:U51"><span class="var type1" id="S40T1U67">i</span>=<span class="mxinfo" id="T1:U53">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo" id="T1:U54"><span class="var type1" id="S41T1U71">deltaTNext</span>=<span class="mxinfo" id="T1:U56">abs(<span class="mxinfo" id="T1:U57"><span class="mxinfo" id="T1:U58"><span class="var type1" id="S8T7U76">T</span>(<span class="mxinfo" id="T1:U60">2</span>)</span>-<span class="var type1" id="S31T1U78">dt</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo" id="T1:U62"><span class="var type1" id="S43T1U81">deltaT</span>=<span class="mxinfo" id="T1:U64">abs(<span class="mxinfo" id="T1:U65"><span class="var type1" id="S8T7U85">T</span>(<span class="mxinfo" id="T1:U67">2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo" id="T1:U68"><span class="var type1" id="S2T1U89">err</span>=<span class="mxinfo" id="T1:U70">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo" id="T1:U71"><span class="var type1" id="S44T1U93">E</span>=<span class="mxinfo" id="T1:U73">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,14" id="srcline14">14</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S45T1U97">j</span>=<span class="mxinfo" id="T1:U75">1</span>:<span class="mxinfo" id="T1:U76"><span class="var type1" id="S33T1U101">nT</span>-<span class="mxinfo" id="T1:U78">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="28,15" id="srcline15">15</a></span><span class="line">        <span class="mxinfo" id="T1:U79"><span class="var type1" id="S46T1U105">t</span>=<span class="mxinfo" id="T1:U81"><span class="var type1" id="S45T1U107">j</span>*<span class="var type1" id="S31T1U108">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,16" id="srcline16">16</a></span><span class="line">        <span class="mxinfo" id="T1:U84"><span class="var type1" id="S47T1U111">A</span>=<span class="mxinfo" id="T1:U86"><span class="var type1" id="S6T1U113">amp</span>*(<span class="mxinfo" id="T1:U88"><span class="mxinfo" id="T1:U89"><span class="fcn" id="F49N6:B117">heavi</span>(<span class="mxinfo" id="T1:U90"><span class="var type1" id="S46T1U119">t</span>-<span class="var type1" id="S3T1U120">ton</span></span>)</span>-<span class="mxinfo" id="T1:U93"><span class="fcn" id="F49N6:B122">heavi</span>(<span class="mxinfo" id="T1:U94"><span class="var type1" id="S46T1U124">t</span>-<span class="var type1" id="S4T1U125">toff</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,17" id="srcline17">17</a></span><span class="line">        <span class="mxinfo" id="T1:U97"><span class="mxinfo" id="T1:U98"><span class="var type1" id="S37T6U129">yup</span>(<span class="mxinfo" id="T1:U100">1</span>)</span>=<span class="mxinfo" id="T1:U101">(<span class="mxinfo" id="T1:U102"><span class="mxinfo" id="T1:U103"><span class="var type1" id="S36T6U135">ycurr</span>(<span class="mxinfo" id="T1:U105">1</span>)</span>+<span class="mxinfo" id="T1:U106"><span class="var type1" id="S31T1U138">dt</span>*(<span class="mxinfo" id="T1:U108"><span class="mxinfo" id="T1:U109"><span class="mxinfo" id="T1:U110"><span class="var type1" id="S11T1U143">k1</span>*<span class="mxinfo" id="T1:U112"><span class="var type1" id="S36T6U145">ycurr</span>(<span class="mxinfo" id="T1:U114">2</span>)</span></span>+<span class="mxinfo" id="T1:U115"><span class="var type1" id="S17T1U148">L1</span>*<span class="mxinfo" id="T1:U117"><span class="var type1" id="S36T6U150">ycurr</span>(<span class="mxinfo" id="T1:U119">4</span>)</span></span></span>+<span class="mxinfo" id="T1:U120"><span class="var type1" id="S20T1U153">H1</span>*<span class="mxinfo" id="T1:U122"><span class="var type1" id="S36T6U155">ycurr</span>(<span class="mxinfo" id="T1:U124">9</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U125"><span class="mxinfo" id="T1:U126">1</span>+<span class="mxinfo" id="T1:U127"><span class="var type1" id="S31T1U161">dt</span>*(<span class="mxinfo" id="T1:U129"><span class="mxinfo" id="T1:U130"><span class="mxinfo" id="T1:U131">3</span>*<span class="var type1" id="S12T1U166">k2</span></span>*<span class="var type1" id="S47T1U167">A</span></span>)</span></span>)</span></span>;<span class="comment">%C1</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,18" id="srcline18">18</a></span><span class="line">        <span class="mxinfo" id="T1:U134"><span class="mxinfo" id="T1:U135"><span class="var type1" id="S37T6U171">yup</span>(<span class="mxinfo" id="T1:U137">2</span>)</span>=<span class="mxinfo" id="T1:U138">(<span class="mxinfo" id="T1:U139"><span class="mxinfo" id="T1:U140"><span class="var type1" id="S36T6U177">ycurr</span>(<span class="mxinfo" id="T1:U142">2</span>)</span>+<span class="mxinfo" id="T1:U143"><span class="var type1" id="S31T1U180">dt</span>*(<span class="mxinfo" id="T1:U145"><span class="mxinfo" id="T1:U146"><span class="mxinfo" id="T1:U147"><span class="mxinfo" id="T1:U148"><span class="mxinfo" id="T1:U149"><span class="mxinfo" id="T1:U150">3</span>*<span class="var type1" id="S12T1U188">k2</span></span>*<span class="var type1" id="S47T1U189">A</span></span>*<span class="mxinfo" id="T1:U153"><span class="var type1" id="S36T6U191">ycurr</span>(<span class="mxinfo" id="T1:U155">1</span>)</span></span>+<span class="mxinfo" id="T1:U156"><span class="mxinfo" id="T1:U157"><span class="mxinfo" id="T1:U158">2</span>*<span class="var type1" id="S13T1U196">k3</span></span>*<span class="mxinfo" id="T1:U160"><span class="var type1" id="S36T6U198">ycurr</span>(<span class="mxinfo" id="T1:U162">5</span>)</span></span></span>+<span class="mxinfo" id="T1:U163"><span class="var type1" id="S21T1U201">H2</span>*<span class="mxinfo" id="T1:U165"><span class="var type1" id="S36T6U203">ycurr</span>(<span class="mxinfo" id="T1:U167">10</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U168"><span class="mxinfo" id="T1:U169">1</span>+<span class="mxinfo" id="T1:U170"><span class="var type1" id="S31T1U209">dt</span>*(<span class="mxinfo" id="T1:U172"><span class="mxinfo" id="T1:U173"><span class="var type1" id="S11T1U213">k1</span>+<span class="mxinfo" id="T1:U175"><span class="mxinfo" id="T1:U176"><span class="mxinfo" id="T1:U177">2</span>*<span class="var type1" id="S14T1U217">k4</span></span>*<span class="var type1" id="S47T1U218">A</span></span></span>+<span class="var type1" id="S22T1U219">H3</span></span>)</span></span>)</span></span>;<span class="comment">%C2</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,19" id="srcline19">19</a></span><span class="line">        <span class="mxinfo" id="T1:U181"><span class="mxinfo" id="T1:U182"><span class="var type1" id="S37T6U223">yup</span>(<span class="mxinfo" id="T1:U184">3</span>)</span>=<span class="mxinfo" id="T1:U185">(<span class="mxinfo" id="T1:U186"><span class="mxinfo" id="T1:U187"><span class="var type1" id="S36T6U229">ycurr</span>(<span class="mxinfo" id="T1:U189">3</span>)</span>+<span class="mxinfo" id="T1:U190"><span class="var type1" id="S31T1U232">dt</span>*(<span class="mxinfo" id="T1:U192"><span class="mxinfo" id="T1:U193"><span class="mxinfo" id="T1:U194"><span class="mxinfo" id="T1:U195"><span class="mxinfo" id="T1:U196">3</span>*<span class="var type1" id="S12T1U239">k2</span></span>*<span class="var type1" id="S47T1U240">A</span></span>*<span class="mxinfo" id="T1:U199"><span class="var type1" id="S36T6U242">ycurr</span>(<span class="mxinfo" id="T1:U201">4</span>)</span></span>+<span class="mxinfo" id="T1:U202"><span class="mxinfo" id="T1:U203"><span class="mxinfo" id="T1:U204">2</span>*<span class="var type1" id="S11T1U247">k1</span></span>*<span class="mxinfo" id="T1:U206"><span class="var type1" id="S36T6U249">ycurr</span>(<span class="mxinfo" id="T1:U208">8</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U209"><span class="mxinfo" id="T1:U210">1</span>+<span class="mxinfo" id="T1:U211"><span class="var type1" id="S31T1U255">dt</span>*(<span class="mxinfo" id="T1:U213"><span class="var type1" id="S11T1U258">k1</span>+<span class="mxinfo" id="T1:U215"><span class="mxinfo" id="T1:U216"><span class="mxinfo" id="T1:U217">2</span>*<span class="var type1" id="S12T1U262">k2</span></span>*<span class="var type1" id="S47T1U263">A</span></span></span>)</span></span>)</span></span>;<span class="comment">%C3</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,20" id="srcline20">20</a></span><span class="line">        <span class="mxinfo" id="T1:U220"><span class="mxinfo" id="T1:U221"><span class="var type1" id="S37T6U267">yup</span>(<span class="mxinfo" id="T1:U223">4</span>)</span>=<span class="mxinfo" id="T1:U224">(<span class="mxinfo" id="T1:U225"><span class="mxinfo" id="T1:U226"><span class="var type1" id="S36T6U273">ycurr</span>(<span class="mxinfo" id="T1:U228">4</span>)</span>+<span class="mxinfo" id="T1:U229"><span class="var type1" id="S31T1U276">dt</span>*(<span class="mxinfo" id="T1:U231"><span class="var type1" id="S11T1U279">k1</span>*<span class="mxinfo" id="T1:U233"><span class="var type1" id="S36T6U281">ycurr</span>(<span class="mxinfo" id="T1:U235">3</span>)</span></span>)</span></span>)/(<span class="mxinfo" id="T1:U236"><span class="mxinfo" id="T1:U237">1</span>+<span class="mxinfo" id="T1:U238"><span class="var type1" id="S31T1U287">dt</span>*(<span class="mxinfo" id="T1:U240"><span class="mxinfo" id="T1:U241"><span class="mxinfo" id="T1:U242"><span class="mxinfo" id="T1:U243">3</span>*<span class="var type1" id="S12T1U293">k2</span></span>*<span class="var type1" id="S47T1U294">A</span></span>+<span class="var type1" id="S17T1U295">L1</span></span>)</span></span>)</span></span>;<span class="comment">%C4</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,21" id="srcline21">21</a></span><span class="line">        <span class="mxinfo" id="T1:U247"><span class="mxinfo" id="T1:U248"><span class="var type1" id="S37T6U299">yup</span>(<span class="mxinfo" id="T1:U250">5</span>)</span>=<span class="mxinfo" id="T1:U251">(<span class="mxinfo" id="T1:U252"><span class="mxinfo" id="T1:U253"><span class="var type1" id="S36T6U305">ycurr</span>(<span class="mxinfo" id="T1:U255">5</span>)</span>+<span class="mxinfo" id="T1:U256"><span class="var type1" id="S31T1U308">dt</span>*(<span class="mxinfo" id="T1:U258"><span class="mxinfo" id="T1:U259"><span class="mxinfo" id="T1:U260"><span class="mxinfo" id="T1:U261"><span class="mxinfo" id="T1:U262"><span class="mxinfo" id="T1:U263">2</span>*<span class="var type1" id="S14T1U316">k4</span></span>*<span class="var type1" id="S47T1U317">A</span></span>*<span class="mxinfo" id="T1:U266"><span class="var type1" id="S36T6U319">ycurr</span>(<span class="mxinfo" id="T1:U268">2</span>)</span></span>+<span class="mxinfo" id="T1:U269"><span class="mxinfo" id="T1:U270"><span class="mxinfo" id="T1:U271">3</span>*<span class="var type1" id="S15T1U324">k5</span></span>*<span class="mxinfo" id="T1:U273"><span class="var type1" id="S36T6U326">ycurr</span>(<span class="mxinfo" id="T1:U275">6</span>)</span></span></span>+<span class="mxinfo" id="T1:U276"><span class="var type1" id="S23T1U329">H4</span>*<span class="mxinfo" id="T1:U278"><span class="var type1" id="S36T6U331">ycurr</span>(<span class="mxinfo" id="T1:U280">11</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U281"><span class="mxinfo" id="T1:U282">1</span>+<span class="mxinfo" id="T1:U283"><span class="var type1" id="S31T1U337">dt</span>*(<span class="mxinfo" id="T1:U285"><span class="mxinfo" id="T1:U286"><span class="mxinfo" id="T1:U287"><span class="mxinfo" id="T1:U288">2</span>*<span class="var type1" id="S13T1U343">k3</span></span>+<span class="mxinfo" id="T1:U290"><span class="var type1" id="S16T1U345">k6</span>*<span class="var type1" id="S47T1U346">A</span></span></span>+<span class="var type1" id="S24T1U347">H5</span></span>)</span></span>)</span></span>;<span class="comment">%O1</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,22" id="srcline22">22</a></span><span class="line">        <span class="mxinfo" id="T1:U294"><span class="mxinfo" id="T1:U295"><span class="var type1" id="S37T6U351">yup</span>(<span class="mxinfo" id="T1:U297">6</span>)</span>=<span class="mxinfo" id="T1:U298">(<span class="mxinfo" id="T1:U299"><span class="mxinfo" id="T1:U300"><span class="var type1" id="S36T6U357">ycurr</span>(<span class="mxinfo" id="T1:U302">6</span>)</span>+<span class="mxinfo" id="T1:U303"><span class="var type1" id="S31T1U360">dt</span>*(<span class="mxinfo" id="T1:U305"><span class="mxinfo" id="T1:U306"><span class="mxinfo" id="T1:U307"><span class="mxinfo" id="T1:U308"><span class="var type1" id="S16T1U366">k6</span>*<span class="var type1" id="S47T1U367">A</span></span>*<span class="mxinfo" id="T1:U311"><span class="var type1" id="S36T6U369">ycurr</span>(<span class="mxinfo" id="T1:U313">5</span>)</span></span>+<span class="mxinfo" id="T1:U314"><span class="var type1" id="S18T1U372">L2</span>*<span class="mxinfo" id="T1:U316"><span class="var type1" id="S36T6U374">ycurr</span>(<span class="mxinfo" id="T1:U318">7</span>)</span></span></span>+<span class="mxinfo" id="T1:U319"><span class="var type1" id="S25T1U377">H6</span>*<span class="mxinfo" id="T1:U321"><span class="var type1" id="S36T6U379">ycurr</span>(<span class="mxinfo" id="T1:U323">12</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U324"><span class="mxinfo" id="T1:U325">1</span>+<span class="mxinfo" id="T1:U326"><span class="var type1" id="S31T1U385">dt</span>*(<span class="mxinfo" id="T1:U328"><span class="mxinfo" id="T1:U329"><span class="mxinfo" id="T1:U330"><span class="mxinfo" id="T1:U331">3</span>*<span class="var type1" id="S15T1U391">k5</span></span>+<span class="var type1" id="S19T1U392">L3</span></span>+<span class="var type1" id="S26T1U393">H7</span></span>)</span></span>)</span></span>;<span class="comment">%O2</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,23" id="srcline23">23</a></span><span class="line">        <span class="mxinfo" id="T1:U335"><span class="mxinfo" id="T1:U336"><span class="var type1" id="S37T6U397">yup</span>(<span class="mxinfo" id="T1:U338">7</span>)</span>=<span class="mxinfo" id="T1:U339">(<span class="mxinfo" id="T1:U340"><span class="mxinfo" id="T1:U341"><span class="var type1" id="S36T6U403">ycurr</span>(<span class="mxinfo" id="T1:U343">7</span>)</span>+<span class="mxinfo" id="T1:U344"><span class="var type1" id="S31T1U406">dt</span>*(<span class="mxinfo" id="T1:U346"><span class="mxinfo" id="T1:U347"><span class="mxinfo" id="T1:U348"><span class="var type1" id="S12T1U411">k2</span>*<span class="var type1" id="S47T1U412">A</span></span>*<span class="mxinfo" id="T1:U351"><span class="var type1" id="S36T6U414">ycurr</span>(<span class="mxinfo" id="T1:U353">8</span>)</span></span>+<span class="mxinfo" id="T1:U354"><span class="var type1" id="S19T1U417">L3</span>*<span class="mxinfo" id="T1:U356"><span class="var type1" id="S36T6U419">ycurr</span>(<span class="mxinfo" id="T1:U358">6</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U359"><span class="mxinfo" id="T1:U360">1</span>+<span class="mxinfo" id="T1:U361"><span class="var type1" id="S31T1U425">dt</span>*(<span class="mxinfo" id="T1:U363"><span class="mxinfo" id="T1:U364"><span class="mxinfo" id="T1:U365">3</span>*<span class="var type1" id="S11T1U430">k1</span></span>+<span class="var type1" id="S18T1U431">L2</span></span>)</span></span>)</span></span>;<span class="comment">%O3</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,24" id="srcline24">24</a></span><span class="line">        <span class="mxinfo" id="T1:U368"><span class="mxinfo" id="T1:U369"><span class="var type1" id="S37T6U435">yup</span>(<span class="mxinfo" id="T1:U371">8</span>)</span>=<span class="mxinfo" id="T1:U372">(<span class="mxinfo" id="T1:U373"><span class="mxinfo" id="T1:U374"><span class="var type1" id="S36T6U441">ycurr</span>(<span class="mxinfo" id="T1:U376">8</span>)</span>+<span class="mxinfo" id="T1:U377"><span class="var type1" id="S31T1U444">dt</span>*(<span class="mxinfo" id="T1:U379"><span class="mxinfo" id="T1:U380"><span class="mxinfo" id="T1:U381"><span class="mxinfo" id="T1:U382"><span class="mxinfo" id="T1:U383">2</span>*<span class="var type1" id="S12T1U451">k2</span></span>*<span class="var type1" id="S47T1U452">A</span></span>*<span class="mxinfo" id="T1:U386"><span class="var type1" id="S36T6U454">ycurr</span>(<span class="mxinfo" id="T1:U388">3</span>)</span></span>+<span class="mxinfo" id="T1:U389"><span class="mxinfo" id="T1:U390"><span class="mxinfo" id="T1:U391">3</span>*<span class="var type1" id="S11T1U459">k1</span></span>*<span class="mxinfo" id="T1:U393"><span class="var type1" id="S36T6U461">ycurr</span>(<span class="mxinfo" id="T1:U395">7</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U396"><span class="mxinfo" id="T1:U397">1</span>+<span class="mxinfo" id="T1:U398"><span class="var type1" id="S31T1U467">dt</span>*(<span class="mxinfo" id="T1:U400"><span class="mxinfo" id="T1:U401"><span class="mxinfo" id="T1:U402">2</span>*<span class="var type1" id="S11T1U472">k1</span></span>+<span class="mxinfo" id="T1:U404"><span class="var type1" id="S12T1U474">k2</span>*<span class="var type1" id="S47T1U475">A</span></span></span>)</span></span>)</span></span>;<span class="comment">%O4</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,25" id="srcline25">25</a></span><span class="line">        <span class="mxinfo" id="T1:U407"><span class="mxinfo" id="T1:U408"><span class="var type1" id="S37T6U479">yup</span>(<span class="mxinfo" id="T1:U410">9</span>)</span>=<span class="mxinfo" id="T1:U411">(<span class="mxinfo" id="T1:U412"><span class="mxinfo" id="T1:U413"><span class="var type1" id="S36T6U485">ycurr</span>(<span class="mxinfo" id="T1:U415">9</span>)</span>+<span class="mxinfo" id="T1:U416"><span class="var type1" id="S31T1U488">dt</span>*(<span class="mxinfo" id="T1:U418"><span class="var type1" id="S11T1U491">k1</span>*<span class="mxinfo" id="T1:U420"><span class="var type1" id="S36T6U493">ycurr</span>(<span class="mxinfo" id="T1:U422">10</span>)</span></span>)</span></span>)/(<span class="mxinfo" id="T1:U423"><span class="mxinfo" id="T1:U424">1</span>+<span class="mxinfo" id="T1:U425"><span class="var type1" id="S31T1U499">dt</span>*(<span class="mxinfo" id="T1:U427"><span class="mxinfo" id="T1:U428"><span class="mxinfo" id="T1:U429"><span class="mxinfo" id="T1:U430">3</span>*<span class="var type1" id="S12T1U505">k2</span></span>*<span class="var type1" id="S47T1U506">A</span></span>+<span class="var type1" id="S20T1U507">H1</span></span>)</span></span>)</span></span>;<span class="comment">%D1</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,26" id="srcline26">26</a></span><span class="line">        <span class="mxinfo" id="T1:U434"><span class="mxinfo" id="T1:U435"><span class="var type1" id="S37T6U511">yup</span>(<span class="mxinfo" id="T1:U437">10</span>)</span>=<span class="mxinfo" id="T1:U438">(<span class="mxinfo" id="T1:U439"><span class="mxinfo" id="T1:U440"><span class="var type1" id="S36T6U517">ycurr</span>(<span class="mxinfo" id="T1:U442">10</span>)</span>+<span class="mxinfo" id="T1:U443"><span class="var type1" id="S31T1U520">dt</span>*(<span class="mxinfo" id="T1:U445"><span class="mxinfo" id="T1:U446"><span class="mxinfo" id="T1:U447"><span class="mxinfo" id="T1:U448"><span class="mxinfo" id="T1:U449"><span class="mxinfo" id="T1:U450">3</span>*<span class="var type1" id="S12T1U528">k2</span></span>*<span class="var type1" id="S47T1U529">A</span></span>*<span class="mxinfo" id="T1:U453"><span class="var type1" id="S36T6U531">ycurr</span>(<span class="mxinfo" id="T1:U455">9</span>)</span></span>+<span class="mxinfo" id="T1:U456"><span class="mxinfo" id="T1:U457"><span class="mxinfo" id="T1:U458">2</span>*<span class="var type1" id="S13T1U536">k3</span></span>*<span class="mxinfo" id="T1:U460"><span class="var type1" id="S36T6U538">ycurr</span>(<span class="mxinfo" id="T1:U462">11</span>)</span></span></span>+<span class="mxinfo" id="T1:U463"><span class="var type1" id="S22T1U541">H3</span>*<span class="mxinfo" id="T1:U465"><span class="var type1" id="S36T6U543">ycurr</span>(<span class="mxinfo" id="T1:U467">2</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U468"><span class="mxinfo" id="T1:U469">1</span>+<span class="mxinfo" id="T1:U470"><span class="var type1" id="S31T1U549">dt</span>*(<span class="mxinfo" id="T1:U472"><span class="mxinfo" id="T1:U473"><span class="var type1" id="S11T1U553">k1</span>+<span class="mxinfo" id="T1:U475"><span class="mxinfo" id="T1:U476"><span class="mxinfo" id="T1:U477">2</span>*<span class="var type1" id="S14T1U557">k4</span></span>*<span class="var type1" id="S47T1U558">A</span></span></span>+<span class="var type1" id="S21T1U559">H2</span></span>)</span></span>)</span></span>;<span class="comment">%D2</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,27" id="srcline27">27</a></span><span class="line">        <span class="mxinfo" id="T1:U481"><span class="mxinfo" id="T1:U482"><span class="var type1" id="S37T6U563">yup</span>(<span class="mxinfo" id="T1:U484">11</span>)</span>=<span class="mxinfo" id="T1:U485">(<span class="mxinfo" id="T1:U486"><span class="mxinfo" id="T1:U487"><span class="var type1" id="S36T6U569">ycurr</span>(<span class="mxinfo" id="T1:U489">11</span>)</span>+<span class="mxinfo" id="T1:U490"><span class="var type1" id="S31T1U572">dt</span>*(<span class="mxinfo" id="T1:U492"><span class="mxinfo" id="T1:U493"><span class="mxinfo" id="T1:U494"><span class="mxinfo" id="T1:U495"><span class="mxinfo" id="T1:U496">2</span>*<span class="var type1" id="S14T1U579">k4</span></span>*<span class="var type1" id="S47T1U580">A</span></span>*<span class="mxinfo" id="T1:U499"><span class="var type1" id="S36T6U582">ycurr</span>(<span class="mxinfo" id="T1:U501">10</span>)</span></span>+<span class="mxinfo" id="T1:U502"><span class="var type1" id="S24T1U585">H5</span>*<span class="mxinfo" id="T1:U504"><span class="var type1" id="S36T6U587">ycurr</span>(<span class="mxinfo" id="T1:U506">5</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U507"><span class="mxinfo" id="T1:U508">1</span>+<span class="mxinfo" id="T1:U509"><span class="var type1" id="S31T1U593">dt</span>*(<span class="mxinfo" id="T1:U511"><span class="mxinfo" id="T1:U512"><span class="mxinfo" id="T1:U513">2</span>*<span class="var type1" id="S13T1U598">k3</span></span>+<span class="var type1" id="S23T1U599">H4</span></span>)</span></span>)</span></span>;<span class="comment">%D3</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,28" id="srcline28">28</a></span><span class="line">        <span class="mxinfo" id="T1:U516"><span class="mxinfo" id="T1:U517"><span class="var type1" id="S37T6U603">yup</span>(<span class="mxinfo" id="T1:U519">12</span>)</span>=<span class="mxinfo" id="T1:U520">(<span class="mxinfo" id="T1:U521"><span class="mxinfo" id="T1:U522"><span class="var type1" id="S36T6U609">ycurr</span>(<span class="mxinfo" id="T1:U524">12</span>)</span>+<span class="mxinfo" id="T1:U525"><span class="var type1" id="S31T1U612">dt</span>*(<span class="mxinfo" id="T1:U527"><span class="mxinfo" id="T1:U528"><span class="mxinfo" id="T1:U529"><span class="mxinfo" id="T1:U530"><span class="mxinfo" id="T1:U531">3</span>*<span class="var type1" id="S15T1U619">k5</span></span>*<span class="mxinfo" id="T1:U533"><span class="var type1" id="S36T6U621">ycurr</span>(<span class="mxinfo" id="T1:U535">12</span>)</span></span>+<span class="mxinfo" id="T1:U536"><span class="mxinfo" id="T1:U537"><span class="var type1" id="S16T1U625">k6</span>*<span class="var type1" id="S47T1U626">A</span></span>*<span class="mxinfo" id="T1:U540"><span class="var type1" id="S36T6U628">ycurr</span>(<span class="mxinfo" id="T1:U542">12</span>)</span></span></span>+<span class="mxinfo" id="T1:U543"><span class="var type1" id="S26T1U631">H7</span>*<span class="mxinfo" id="T1:U545"><span class="var type1" id="S36T6U633">ycurr</span>(<span class="mxinfo" id="T1:U547">6</span>)</span></span></span>)</span></span>)/(<span class="mxinfo" id="T1:U548"><span class="mxinfo" id="T1:U549">1</span>+<span class="mxinfo" id="T1:U550"><span class="var type1" id="S31T1U639">dt</span>*(<span class="mxinfo" id="T1:U552"><span class="mxinfo" id="T1:U553"><span class="mxinfo" id="T1:U554"><span class="var type1" id="S16T1U644">k6</span>*<span class="var type1" id="S47T1U645">A</span></span>+<span class="mxinfo" id="T1:U557"><span class="mxinfo" id="T1:U558">3</span>*<span class="var type1" id="S15T1U648">k5</span></span></span>+<span class="var type1" id="S25T1U649">H6</span></span>)</span></span>)</span></span>;<span class="comment">%D4</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,29" id="srcline29">29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,30" id="srcline30">30</a></span><span class="line">        <span class="mxinfo" id="T6:U561"><span class="var type1" id="S36T6U652">ycurr</span>=<span class="var type1" id="S37T6U653">yup</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,31" id="srcline31">31</a></span><span class="line">        <span class="mxinfo" id="T1:U564"><span class="var type1" id="S49T1U656">deltaTPrev</span>=<span class="var type1" id="S43T1U657">deltaT</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,32" id="srcline32">32</a></span><span class="line">        <span class="mxinfo" id="T1:U567"><span class="var type1" id="S43T1U660">deltaT</span>=<span class="var type1" id="S41T1U661">deltaTNext</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,33" id="srcline33">33</a></span><span class="line">        <span class="mxinfo" id="T1:U570"><span class="var type1" id="S41T1U664">deltaTNext</span>=<span class="mxinfo" id="T1:U572">abs(<span class="mxinfo" id="T1:U573"><span class="mxinfo" id="T1:U574"><span class="var type1" id="S8T7U669">T</span>(<span class="var type1" id="S40T1U670">i</span>)</span>-<span class="mxinfo" id="T1:U577">(<span class="mxinfo" id="T1:U578"><span class="var type1" id="S45T1U674">j</span>+<span class="mxinfo" id="T1:U580">1</span></span>)*<span class="var type1" id="S31T1U676">dt</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,34" id="srcline34">34</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="28,35" id="srcline35">35</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T4:U582"><span class="var type1" id="S43T1U681">deltaT</span>&lt;<span class="var type1" id="S41T1U682">deltaTNext</span></span> &amp;&amp; <span class="mxinfo" id="T4:U585"><span class="var type1" id="S43T1U684">deltaT</span>&lt;<span class="var type1" id="S49T1U685">deltaTPrev</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="28,36" id="srcline36">36</a></span><span class="line">            <span class="mxinfo" id="T1:U588"><span class="var type1" id="S2T1U688">err</span>=<span class="mxinfo" id="T1:U590"><span class="var type1" id="S2T1U690">err</span>+<span class="mxinfo" id="T1:U592"><span class="mxinfo" id="T1:U593">abs(<span class="mxinfo" id="T1:U594"><span class="mxinfo" id="T1:U595"><span class="mxinfo" id="T1:U596">10^12</span>*(<span class="mxinfo" id="T1:U597"><span class="mxinfo" id="T1:U598"><span class="mxinfo" id="T1:U599"><span class="var type1" id="S27T1U703">g12</span>*(<span class="mxinfo" id="T1:U601"><span class="mxinfo" id="T1:U602"><span class="var type1" id="S36T6U707">ycurr</span>(<span class="mxinfo" id="T1:U604">5</span>)</span>+<span class="mxinfo" id="T1:U605"><span class="var type1" id="S36T6U710">ycurr</span>(<span class="mxinfo" id="T1:U607">6</span>)</span></span>)</span>*(<span class="mxinfo" id="T1:U608"><span class="mxinfo" id="T1:U609"><span class="var type1" id="S10T1U714">V</span></span>-<span class="var type1" id="S29T1U715">E12</span></span>)</span>+<span class="mxinfo" id="T1:U612"><span class="mxinfo" id="T1:U613"><span class="var type1" id="S28T1U718">g34</span>*(<span class="mxinfo" id="T1:U615"><span class="mxinfo" id="T1:U616"><span class="var type1" id="S36T6U722">ycurr</span>(<span class="mxinfo" id="T1:U618">7</span>)</span>+<span class="mxinfo" id="T1:U619"><span class="var type1" id="S36T6U725">ycurr</span>(<span class="mxinfo" id="T1:U621">8</span>)</span></span>)</span>*(<span class="mxinfo" id="T1:U622"><span class="mxinfo" id="T1:U623"><span class="var type1" id="S10T1U729">V</span></span>-<span class="var type1" id="S30T1U730">E34</span></span>)</span></span>)</span>-<span class="mxinfo" id="T1:U626"><span class="var type1" id="S9T7U732">I</span>(<span class="var type1" id="S40T1U733">i</span>)</span></span>)</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,37" id="srcline37">37</a></span><span class="line">            <span class="mxinfo" id="T1:U629"><span class="var type1" id="S40T1U737">i</span>=<span class="mxinfo" id="T1:U631"><span class="var type1" id="S40T1U739">i</span>+<span class="mxinfo" id="T1:U633">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,38" id="srcline38">38</a></span><span class="line">            <span class="mxinfo" id="T1:U634"><span class="var type1" id="S50T1U743">Tcurr</span>=<span class="mxinfo" id="T1:U636"><span class="var type1" id="S8T7U745">T</span>(<span class="var type1" id="S40T1U746">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,39" id="srcline39">39</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,40" id="srcline40">40</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,41" id="srcline41">41</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
