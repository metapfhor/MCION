<pre class="code">
<span class="srcline"><span class="lineno"><a href="72,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> linearODESSEcalP2X7(<span class="var type1" id="S2T3U5">T</span>,<span class="var type1" id="S3T3U6">I</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="72,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">global</span> <span class="var type0" id="S4T0U8">k1</span> <span class="var type0" id="S5T0U9">k2</span> <span class="var type0" id="S6T0U10">k3</span> <span class="var type0" id="S7T0U11">k4</span> <span class="var type0" id="S8T0U12">k5</span> <span class="var type0" id="S9T0U13">k6</span> <span class="var type0" id="S10T0U14">L1</span> <span class="var type0" id="S11T0U15">L2</span> <span class="var type0" id="S12T0U16">L3</span> <span class="var type0" id="S13T0U17">H1</span> <span class="var type0" id="S14T0U18">H2</span> <span class="var type0" id="S15T0U19">H3</span> <span class="var type0" id="S16T0U20">H4</span> <span class="var type0" id="S17T0U21">H5</span> <span class="var type0" id="S18T0U22">H6</span> <span class="var type0" id="S19T0U23">H7</span> <span class="var type0" id="S20T0U24">r1</span> <span class="var type0" id="S21T0U25">r2</span> <span class="var type0" id="S22T0U26">kca</span> <span class="var type0" id="S23T0U27">koff</span> <span class="var type0" id="S24T0U28">C</span> <span class="var type1" id="S25T2U29">g12</span> <span class="var type1" id="S26T2U30">g34</span> <span class="var type1" id="S27T2U31">E12</span> <span class="var type1" id="S28T2U32">E34</span> <span class="var type0" id="S29T0U33">A</span> <span class="var type1" id="S30T2U34">V</span> <span class="var type1" id="S31T2U35">Acell</span> <span class="var type2" id="S32T0U36">p0</span> <span class="var type2" id="S33T0U37">err</span> <span class="var type1" id="S34T9U38">Q</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,3" id="srcline3"> 3</a></span><span class="line">    <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="72,4" id="srcline4"> 4</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="72,5" id="srcline5"> 5</a></span><span class="line">    <span class="fcn" id="F13N3:B41">generatorMatrixcalP2X7</span>();</span></span>
<span class="srcline"><span class="lineno"><a href="72,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo" id="T2:U10"><span class="var type1" id="S36T2U44">Nt</span>=<span class="mxinfo" id="T2:U12">length(<span class="var type1" id="S2T3U47">T</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,7" id="srcline7"> 7</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="72,8" id="srcline8"> 8</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="72,9" id="srcline9"> 9</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S38T2U50">i</span>=<span class="mxinfo" id="T2:U15">1</span>:<span class="var type1" id="S36T2U53">Nt</span></span></span>
<span class="srcline"><span class="lineno"><a href="72,10" id="srcline10">10</a></span><span class="line">        <span class="mxinfo" id="T10:U17"><span class="var type1" id="S32T10U56">p0</span>=<span class="mxinfo" id="T10:U19"><span class="var type1" id="S32T10U58">p0</span>*<span class="mxinfo" id="T9:U21">expm(<span class="mxinfo" id="T9:U22"><span class="var type1" id="S34T9U62">Q</span>*<span class="mxinfo" id="T2:U24"><span class="var type1" id="S2T3U64">T</span>(<span class="var type1" id="S38T2U65">i</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,11" id="srcline11">11</a></span><span class="line">        <span class="mxinfo" id="T2:U27"><span class="var type1" id="S33T2U68">err</span>=<span class="mxinfo" id="T2:U29"><span class="var type1" id="S33T2U70">err</span>+<span class="mxinfo" id="T2:U31"><span class="mxinfo" id="T2:U32">abs(<span class="mxinfo" id="T2:U33"><span class="mxinfo" id="T2:U34"><span class="mxinfo" id="T2:U35"><span class="var type1" id="S31T2U77">Acell</span>*<span class="mxinfo" id="T2:U37">10^12</span></span>*(<span class="mxinfo" id="T2:U38"><span class="mxinfo" id="T2:U39"><span class="mxinfo" id="T2:U40"><span class="var type1" id="S25T2U85">g12</span>*(<span class="mxinfo" id="T2:U42"><span class="mxinfo" id="T2:U43"><span class="mxinfo" id="T2:U44"><span class="mxinfo" id="T2:U45"><span class="var type1" id="S32T10U91">p0</span>(<span class="mxinfo" id="T2:U47">5</span>)</span>+<span class="mxinfo" id="T2:U48"><span class="var type1" id="S32T10U94">p0</span>(<span class="mxinfo" id="T2:U50">6</span>)</span></span>+<span class="mxinfo" id="T2:U51"><span class="var type1" id="S32T10U97">p0</span>(<span class="mxinfo" id="T2:U53">15</span>)</span></span>+<span class="mxinfo" id="T2:U54"><span class="var type1" id="S32T10U100">p0</span>(<span class="mxinfo" id="T2:U56">16</span>)</span></span>)</span>*(<span class="mxinfo" id="T2:U57"><span class="var type1" id="S30T2U104">V</span>-<span class="var type1" id="S27T2U105">E12</span></span>)</span>+<span class="mxinfo" id="T2:U60"><span class="mxinfo" id="T2:U61"><span class="var type1" id="S26T2U108">g34</span>*(<span class="mxinfo" id="T2:U63"><span class="mxinfo" id="T2:U64"><span class="mxinfo" id="T2:U65"><span class="mxinfo" id="T2:U66"><span class="var type1" id="S32T10U114">p0</span>(<span class="mxinfo" id="T2:U68">7</span>)</span>+<span class="mxinfo" id="T2:U69"><span class="var type1" id="S32T10U117">p0</span>(<span class="mxinfo" id="T2:U71">8</span>)</span></span>+<span class="mxinfo" id="T2:U72"><span class="var type1" id="S32T10U120">p0</span>(<span class="mxinfo" id="T2:U74">24</span>)</span></span>+<span class="mxinfo" id="T2:U75"><span class="var type1" id="S32T10U123">p0</span>(<span class="mxinfo" id="T2:U77">23</span>)</span></span>)</span>*(<span class="mxinfo" id="T2:U78"><span class="var type1" id="S30T2U127">V</span>-<span class="var type1" id="S28T2U128">E34</span></span>)</span></span>)</span>-<span class="mxinfo" id="T2:U81"><span class="var type1" id="S3T3U130">I</span>(<span class="var type1" id="S38T2U131">i</span>)</span></span>)</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,12" id="srcline12">12</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="72,13" id="srcline13">13</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
