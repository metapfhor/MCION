<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type0" id="S2T0U3">ode</span>=PulseProtSSEP2X4(<span class="var type0" id="S3T0U6">ton</span>,<span class="var type0" id="S4T0U7">toff</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">global</span> <span class="var type0" id="S5T0U9">k1</span> <span class="var type0" id="S6T0U10">k2</span> <span class="var type0" id="S7T0U11">k3</span> <span class="var type0" id="S8T0U12">k4</span> <span class="var type0" id="S9T0U13">k5</span> <span class="var type0" id="S10T0U14">k6</span> <span class="var type0" id="S11T0U15">L1</span> <span class="var type0" id="S12T0U16">L2</span> <span class="var type0" id="S13T0U17">L3</span> <span class="var type0" id="S14T0U18">L4</span> <span class="var type0" id="S15T0U19">H1</span> <span class="var type0" id="S16T0U20">H2</span> <span class="var type0" id="S17T0U21">H3</span> <span class="var type0" id="S18T0U22">H4</span> <span class="var type0" id="S19T0U23">g1</span> <span class="var type0" id="S20T0U24">g2</span> <span class="var type0" id="S21T0U25">E1</span> <span class="var type0" id="S22T0U26">E2</span> <span class="var type0" id="S23T0U27">A0</span> <span class="var type0" id="S24T0U28">J0</span> <span class="var type0" id="S25T0U29">IVMon</span> <span class="var type0" id="S26T0U30">IVMoff</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">    <span class="var type0" id="S27T0U33">ATP</span>=<span class="message fatal" id="M1F1C">@(t) 0</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">    <span class="keyword">for</span> <span class="var type0" id="S28T0U39">i</span>=1:length(<span class="var type0" id="S3T0U44">ton</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">        <span class="var type0" id="S27T0U47">ATP</span>= @(t) <span class="var type0" id="S27T0U52">ATP</span>(t) + (<span class="var type0" id="S23T0U56">A0</span>*(heaviside(t-<span class="var type0" id="S3T0U64">ton</span>(<span class="var type0" id="S28T0U65">i</span>))-heaviside(t-<span class="var type0" id="S4T0U71">toff</span>(<span class="var type0" id="S28T0U72">i</span>))));</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%     ATP=ATP1+ATP2+ATP3+ATP4+ATP5+ATP6+ATP7+ATP8+ATP9+ATP10+ATP11;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="comment">% %     ATP1=@(t) A0*(heaviside(t-ton(1))-heaviside(t-toff(1)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="var type0" id="S31T0U75">IVM</span>=@(t) <span class="var type0" id="S24T0U79">J0</span>*(heaviside(t-<span class="var type0" id="S25T0U86">IVMon</span>)-heaviside(t-<span class="var type0" id="S26T0U91">IVMoff</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">function</span> <span class="var type0" id="S33T0U94">dy</span>=model(<span class="var type0" id="S34T0U97">t</span>,<span class="var type0" id="S35T0U98">y</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">        <span class="var type0" id="S33T0U101">dy</span>=zeros(9,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">        <span class="var type0" id="S37T0U108">A</span>=<span class="var type0" id="S27T0U110">ATP</span>(<span class="var type0" id="S34T0U111">t</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">        <span class="var type0" id="S39T0U114">J</span>=<span class="var type0" id="S31T0U116">IVM</span>(<span class="var type0" id="S34T0U117">t</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">        <span class="var type0" id="S33T0U121">dy</span>(1)=<span class="var type0" id="S5T0U128">k1</span>*<span class="var type0" id="S35T0U130">y</span>(4)+<span class="var type0" id="S11T0U133">L1</span>*<span class="var type0" id="S35T0U135">y</span>(2)+<span class="var type0" id="S15T0U138">H1</span>*<span class="var type0" id="S35T0U140">y</span>(7)+<span class="var type0" id="S18T0U143">H4</span>*<span class="var type0" id="S35T0U145">y</span>(9)-(<span class="var type0" id="S6T0U151">k2</span>*<span class="var type0" id="S37T0U152">A</span>+<span class="var type0" id="S12T0U154">L2</span>*<span class="var type0" id="S39T0U155">J</span>)*<span class="var type0" id="S35T0U157">y</span>(1);<span class="comment">%C1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">        <span class="var type0" id="S33T0U162">dy</span>(2)=<span class="var type0" id="S7T0U168">k3</span>*<span class="var type0" id="S35T0U170">y</span>(5)+<span class="var type0" id="S12T0U174">L2</span>*<span class="var type0" id="S39T0U175">J</span>*<span class="var type0" id="S35T0U177">y</span>(1)+<span class="var type0" id="S13T0U180">L3</span>*<span class="var type0" id="S35T0U182">y</span>(3)-(<span class="var type0" id="S8T0U189">k4</span>*<span class="var type0" id="S37T0U190">A</span>+<span class="var type0" id="S11T0U191">L1</span>+<span class="var type0" id="S14T0U193">L4</span>*<span class="var type0" id="S39T0U194">J</span>)*<span class="var type0" id="S35T0U196">y</span>(2);<span class="comment">%C2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">        <span class="var type0" id="S33T0U201">dy</span>(3)=<span class="var type0" id="S9T0U206">k5</span>*<span class="var type0" id="S35T0U208">y</span>(6)+<span class="var type0" id="S14T0U212">L4</span>*<span class="var type0" id="S39T0U213">J</span>*<span class="var type0" id="S35T0U215">y</span>(2)-(<span class="var type0" id="S10T0U221">k6</span>*<span class="var type0" id="S37T0U222">A</span>+<span class="var type0" id="S13T0U223">L3</span>)*<span class="var type0" id="S35T0U225">y</span>(3);<span class="comment">%C3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">        <span class="var type0" id="S33T0U230">dy</span>(4)=<span class="var type0" id="S6T0U236">k2</span>*<span class="var type0" id="S37T0U237">A</span>*<span class="var type0" id="S35T0U239">y</span>(1)+<span class="var type0" id="S11T0U242">L1</span>*<span class="var type0" id="S35T0U244">y</span>(5)-(<span class="var type0" id="S5T0U250">k1</span>+<span class="var type0" id="S16T0U251">H2</span>+<span class="var type0" id="S12T0U253">L2</span>*<span class="var type0" id="S39T0U254">J</span>)*<span class="var type0" id="S35T0U256">y</span>(4);<span class="comment">%Q1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">        <span class="var type0" id="S33T0U261">dy</span>(5)=<span class="var type0" id="S8T0U268">k4</span>*<span class="var type0" id="S37T0U269">A</span>*<span class="var type0" id="S35T0U271">y</span>(2)+<span class="var type0" id="S12T0U275">L2</span>*<span class="var type0" id="S39T0U276">J</span>*<span class="var type0" id="S35T0U278">y</span>(4)+<span class="var type0" id="S13T0U281">L3</span>*<span class="var type0" id="S35T0U283">y</span>(6)-(<span class="var type0" id="S7T0U289">k3</span>+<span class="var type0" id="S11T0U290">L1</span>+<span class="var type0" id="S14T0U292">L4</span>*<span class="var type0" id="S39T0U293">J</span>)*<span class="var type0" id="S35T0U295">y</span>(5);<span class="comment">%Q2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">        <span class="var type0" id="S33T0U300">dy</span>(6)=<span class="var type0" id="S10T0U306">k6</span>*<span class="var type0" id="S37T0U307">A</span>*<span class="var type0" id="S35T0U309">y</span>(3)+<span class="var type0" id="S14T0U313">L4</span>*<span class="var type0" id="S39T0U314">J</span>*<span class="var type0" id="S35T0U316">y</span>(5)-(<span class="var type0" id="S9T0U321">k5</span>+<span class="var type0" id="S13T0U322">L3</span>)*<span class="var type0" id="S35T0U324">y</span>(6);<span class="comment">%Q3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">        <span class="var type0" id="S33T0U329">dy</span>(7)=<span class="var type0" id="S5T0U333">k1</span>*<span class="var type0" id="S35T0U335">y</span>(8)-(<span class="var type0" id="S6T0U341">k2</span>*<span class="var type0" id="S37T0U342">A</span>+<span class="var type0" id="S15T0U343">H1</span>)*<span class="var type0" id="S35T0U345">y</span>(7);<span class="comment">%D1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">        <span class="var type0" id="S33T0U350">dy</span>(8)=<span class="var type0" id="S6T0U356">k2</span>*<span class="var type0" id="S37T0U357">A</span>*<span class="var type0" id="S35T0U359">y</span>(7)+<span class="var type0" id="S16T0U362">H2</span>*<span class="var type0" id="S35T0U364">y</span>(4)-(<span class="var type0" id="S5T0U369">k1</span>+<span class="var type0" id="S17T0U370">H3</span>)*<span class="var type0" id="S35T0U372">y</span>(8);<span class="comment">%D2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">        <span class="var type0" id="S33T0U377">dy</span>(9)=<span class="var type0" id="S17T0U381">H3</span>*<span class="var type0" id="S35T0U383">y</span>(8)-<span class="var type0" id="S18T0U386">H4</span>*<span class="var type0" id="S35T0U388">y</span>(9);<span class="comment">%Z</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    <span class="var type0" id="S2T0U392">ode</span>=@ model;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
