<pre class="code">
<span class="srcline"><span class="lineno"><a href="72,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">err</span>,<span class="var type2" id="S3T0U4">p</span>] = linearODESSEP2X4(<span class="var type1" id="S4T7U7">p0</span>,<span class="var type1" id="S5T6U8">T</span>,<span class="var type1" id="S6T6U9">I</span>,<span class="var type1" id="S7T1U10">A</span>,<span class="var type1" id="S8T1U11">V</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="72,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">global</span> <span class="var type0" id="S9T0U13">k1</span> <span class="var type0" id="S10T0U14">k2</span> <span class="var type0" id="S11T0U15">k3</span> <span class="var type0" id="S12T0U16">k4</span> <span class="var type0" id="S13T0U17">k5</span> <span class="var type0" id="S14T0U18">k6</span> <span class="var type0" id="S15T0U19">k7</span> <span class="var type0" id="S16T0U20">k8</span> <span class="var type0" id="S17T0U21">k9</span> <span class="var type0" id="S18T0U22">k10</span> <span class="var type0" id="S19T0U23">k11</span> <span class="var type0" id="S20T0U24">k12</span> <span class="var type0" id="S21T0U25">k13</span> <span class="var type0" id="S22T0U26">k14</span> <span class="var type0" id="S23T0U27">k15</span> <span class="var type0" id="S24T0U28">k16</span> <span class="var type0" id="S25T0U29">k17</span> <span class="var type0" id="S26T0U30">k18</span> <span class="var type0" id="S27T0U31">L1</span> <span class="var type0" id="S28T0U32">L2</span> <span class="var type0" id="S29T0U33">L3</span> <span class="var type0" id="S30T0U34">L4</span> <span class="var type0" id="S31T0U35">H1</span> <span class="var type0" id="S32T0U36">H2</span> <span class="var type0" id="S33T0U37">H3</span> <span class="var type0" id="S34T0U38">H4</span> <span class="var type1" id="S35T1U39">g1</span> <span class="var type1" id="S36T1U40">g2</span> <span class="var type1" id="S37T1U41">E1</span> <span class="var type1" id="S38T1U42">E2</span> <span class="var type1" id="S39T1U43">Acell</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,3" id="srcline3"> 3</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="72,4" id="srcline4"> 4</a></span><span class="line">    <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="72,5" id="srcline5"> 5</a></span><span class="line">    <span class="mxinfo" id="T11:U12"><span class="var type1" id="S40T11U46">Q</span>=<span class="mxinfo" id="T11:U14"><span class="fcn" id="F29N3:B48">generatorMatrixP2X4</span>(<span class="mxinfo" id="T1:U15"><span class="var type1" id="S7T1U49">A</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,6" id="srcline6"> 6</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="72,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo" id="T1:U17"><span class="var type1" id="S42T1U52">Nt</span>=<span class="mxinfo" id="T1:U19">length(<span class="var type1" id="S5T6U55">T</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,8" id="srcline8"> 8</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="72,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo" id="T7:U21"><span class="var type1" id="S3T7U58">p</span>=<span class="mxinfo" id="T7:U23">zeros(<span class="mxinfo" id="T1:U24">1</span>,<span class="mxinfo" id="T1:U25">17</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,10" id="srcline10">10</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="72,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo" id="T1:U26"><span class="var type1" id="S2T1U65">err</span>=<span class="mxinfo" id="T1:U28">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,12" id="srcline12">12</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="72,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S45T1U69">i</span>=<span class="mxinfo" id="T1:U30">1</span>:<span class="var type1" id="S42T1U72">Nt</span></span></span>
<span class="srcline"><span class="lineno"><a href="72,14" id="srcline14">14</a></span><span class="line">        <span class="mxinfo" id="T7:U32"><span class="var type1" id="S3T7U75">p</span>=<span class="mxinfo" id="T7:U34"><span class="var type1" id="S4T7U77">p0</span>*<span class="mxinfo" id="T11:U36">expm(<span class="mxinfo" id="T11:U37"><span class="var type1" id="S40T11U81">Q</span>*<span class="mxinfo" id="T1:U39"><span class="var type1" id="S5T6U83">T</span>(<span class="var type1" id="S45T1U84">i</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,15" id="srcline15">15</a></span><span class="line">        <span class="mxinfo" id="T1:U42"><span class="var type1" id="S2T1U87">err</span>=<span class="mxinfo" id="T1:U44"><span class="var type1" id="S2T1U89">err</span>+<span class="mxinfo" id="T1:U46"><span class="mxinfo" id="T1:U47">abs(<span class="mxinfo" id="T1:U48"><span class="mxinfo" id="T1:U49"><span class="mxinfo" id="T1:U50"><span class="var type1" id="S39T1U96">Acell</span>*<span class="mxinfo" id="T1:U52">10^12</span></span>*(<span class="mxinfo" id="T1:U53"><span class="mxinfo" id="T1:U54"><span class="mxinfo" id="T1:U55"><span class="var type1" id="S35T1U104">g1</span>*(<span class="mxinfo" id="T1:U57"><span class="mxinfo" id="T1:U58"><span class="var type1" id="S3T7U108">p</span>(<span class="mxinfo" id="T1:U60">7</span>)</span>+<span class="mxinfo" id="T1:U61"><span class="var type1" id="S3T7U111">p</span>(<span class="mxinfo" id="T1:U63">8</span>)</span></span>)</span>*(<span class="mxinfo" id="T1:U64"><span class="mxinfo" id="T1:U65"><span class="var type1" id="S8T1U115">V</span></span>-<span class="var type1" id="S37T1U116">E1</span></span>)</span>+<span class="mxinfo" id="T1:U68"><span class="mxinfo" id="T1:U69"><span class="var type1" id="S36T1U119">g2</span>*(<span class="mxinfo" id="T1:U71"><span class="mxinfo" id="T1:U72"><span class="mxinfo" id="T1:U73"><span class="mxinfo" id="T1:U74"><span class="var type1" id="S3T7U125">p</span>(<span class="mxinfo" id="T1:U76">9</span>)</span>+<span class="mxinfo" id="T1:U77"><span class="var type1" id="S3T7U128">p</span>(<span class="mxinfo" id="T1:U79">10</span>)</span></span>+<span class="mxinfo" id="T1:U80"><span class="var type1" id="S3T7U131">p</span>(<span class="mxinfo" id="T1:U82">11</span>)</span></span>+<span class="mxinfo" id="T1:U83"><span class="var type1" id="S3T7U134">p</span>(<span class="mxinfo" id="T1:U85">12</span>)</span></span>)</span>*(<span class="mxinfo" id="T1:U86"><span class="mxinfo" id="T1:U87"><span class="var type1" id="S8T1U138">V</span></span>-<span class="var type1" id="S38T1U139">E2</span></span>)</span></span>)</span>-<span class="mxinfo" id="T1:U90"><span class="var type1" id="S6T6U141">I</span>(<span class="var type1" id="S45T1U142">i</span>)</span></span>)</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="72,16" id="srcline16">16</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="72,17" id="srcline17">17</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
